
AD 1

SET SERVEROUT ON;
CREATE OR REPLACE PROCEDURE ZADANIE_PIERWSZE
(
DEP_NR IN NUMBER,
SUMA OUT NUMBER
) IS
LICZBA NUMBER;
SALARY NUMBER;
COMMISION NUMBER;
BEGIN
SELECT COUNT(*) INTO LICZBA FROM EMP WHERE DEPTNO=DEP_NR;
IF LICZBA = 0 THEN
RAISE NO_DATA_FOUND;
END IF;

SELECT SUM(SAL) INTO SALARY FROM EMP WHERE DEPTNO=DEP_NR;
SELECT SUM(COMM) INTO COMMISION FROM EMP WHERE DEPTNO=DEP_NR AND COMM IS NOT NULL;

IF COMMISION IS NULL THEN
COMMISION := 0;
END IF;

SUMA := SALARY + COMMISION;

 EXCEPTION
 WHEN NO_DATA_FOUND THEN DBMS_OUTPUT.PUT_LINE('PODANY DEPARTAMENT NIE ISTNIEJE');
 WHEN OTHERS THEN DBMS_OUTPUT.PUT_LINE('BLAD');

END;

SET SERVEROUT ON;
DECLARE
zmn NUMBER;
BEGIN

PD209279.ZADANIE_PIERWSZE(20, zmn);
DBMS_OUTPUT.PUT_LINE(zmn);
END;

AD 2

CREATE OR REPLACE FUNCTION LICZBA_M
(DAT IN DATE) RETURN NUMBER
IS

ZMIENNA NUMBER;

BEGIN

select round(sysdate-DAT) INTO ZMIENNA from dual;

RETURN ZMIENNA;
END LICZBA_M

DECLARE
ZM NUMBER;
BEGIN
ZM := LICZBA_M(TO_DATE('1996-12-13'));
DBMS_OUTPUT.PUT_LINE(ZM);
END;

AD 3

DECLARE

TYPE NAMES IS TABLE OF EMP.ENAME%TYPE;
TYPE DNAMES IS TABLE OF DEPT.DNAME%TYPE;

NAS NAMES;
DNAS DNAMES;

CURSOR C1 IS 
SELECT D.DNAME, E.ENAME FROM EMP E INNER JOIN DEPT D ON (E.DEPTNO = D.DEPTNO) WHERE E.SAL > COALESCE(E.COMM, 0);

BEGIN
OPEN C1;
FETCH C1 BULK COLLECT INTO DNAS, NAS;
CLOSE C1;

FOR I IN NAS.FIRST .. NAS.LAST
LOOP
DBMS_OUTPUT.PUT_LINE('ENAME: ' || NAS(I) || ' DEP_NAME: ' || DNAS(I));
END LOOP;
END;

AD 4

CREATE OR REPLACE TRIGGER ZADANIE_CZTERY
BEFORE INSERT ON EMP
FOR EACH ROW
BEGIN

IF :NEW.SAL > 1600 THEN
raise INVALID_NUMBER;
END IF;

END;

DELETE FROM EMP WHERE EMPNO=7935;
INSERT INTO EMP(EMPNO, ENAME, JOB, MGR, SAL, COMM, DEPTNO) VALUES
(7935, 'MASTER', 'SALESMAN', 7698, 1700, 20, 20);
